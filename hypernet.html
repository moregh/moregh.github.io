<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EVE HyperNet Profit Calculator</title>
<style>
* { box-sizing: border-box; }
body { font-family: system-ui, sans-serif; background: #1a1a2e; color: #eee; padding: 15px; max-width: 1200px; margin: 0 auto; }
h1 { color: #00d4ff; text-align: center; margin: 0; }
h1 a { color: inherit; text-decoration: none; }
.section { background: #16213e; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
.section h2 { margin-top: 0; color: #00d4ff; font-size: 1.1em; border-bottom: 1px solid #0f3460; padding-bottom: 10px; }
.row { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
.field { flex: 1; min-width: 150px; position: relative; }
label { display: block; margin-bottom: 5px; color: #aaa; font-size: 0.9em; }
.label-with-tooltip { display: flex; align-items: center; gap: 5px; }
.tooltip-icon { display: inline-flex; align-items: center; justify-content: center; width: 16px; height: 16px; border-radius: 50%; background: #0f3460; color: #00d4ff; font-size: 0.75em; cursor: help; border: 0.8px solid #00d4ff; }
.tooltip-icon:hover { background: #00d4ff; color: #0f3460; }
.tooltip { position: absolute; top: 100%; left: 0; right: 0; background: #0f3460; border: 1px solid #00d4ff; border-radius: 4px; padding: 12px; margin-top: 8px; font-size: 0.85em; line-height: 1.4; z-index: 1000; display: none; box-shadow: 0 4px 12px rgba(0, 212, 255, 0.3); }
.tooltip::after { content: ''; position: absolute; bottom: 100%; left: 20px; border: 6px solid transparent; border-bottom-color: #00d4ff; }
.field:hover .tooltip { display: block; }
.tooltip ol { margin: 8px 0; padding-left: 20px; }
.tooltip li { margin: 4px 0; }
.tooltip code { background: #1a1a2e; padding: 2px 6px; border-radius: 3px; color: #00ff88; }
input, select { width: 100%; padding: 8px; border: 1px solid #0f3460; border-radius: 4px; background: #0f3460; color: #fff; font-size: 1em; }
input:focus, select:focus { outline: none; border-color: #00d4ff; }
.loading { color: #00d4ff; font-size: 0.85em; margin-top: 5px; }
.success { color: #00ff88; font-size: 0.85em; margin-top: 5px; }
.hint { color: #888; font-size: 0.85em; margin-top: 5px; font-style: italic; }
.results { display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; }
.results-runs { grid-template-columns: repeat(6, 1fr); }
.result-item { background: #0f3460; padding: 8px; border-radius: 6px; }
.result-item label { color: #888; font-size: 0.75em; margin-bottom: 3px; }
.result-item .value { font-size: 1em; font-weight: bold; color: #00d4ff; }
.breakdown-table { width: 100%; border-collapse: collapse; }
.breakdown-table th, .breakdown-table td { padding: 12px; text-align: right; border-bottom: 1px solid #0f3460; }
.breakdown-table th:first-child, .breakdown-table td:first-child { text-align: left; }
.breakdown-table th { color: #888; font-weight: normal; font-size: 0.9em; }
.breakdown-table td { color: #00d4ff; font-weight: bold; }
.profit { color: #00ff88 !important; }
.loss { color: #ff4466 !important; }
.error { color: #ff4466; font-size: 0.85em; margin-top: 5px; }
.share-btn { background: #00d4ff; color: #1a1a2e; border: none; padding: 12px 24px; border-radius: 6px; font-size: 1em; font-weight: bold; cursor: pointer; transition: all 0.2s; }
.share-btn:hover { background: #00b8e6; transform: translateY(-1px); }
.share-btn:active { transform: translateY(0); }
.share-result { margin-top: 15px; display: none; }
.share-link { color: #00d4ff; text-decoration: none; font-size: 0.9em; word-break: break-all; padding: 8px; background: #0f3460; border-radius: 4px; display: inline-block; max-width: 100%; border: 1px solid #00d4ff; }
.share-link:hover { background: #1a1a2e; text-decoration: underline; }
.rebate-info { background: #0f3460; padding: 10px; border-radius: 6px; margin-top: 10px; font-size: 0.9em; color: #00ff88; border-left: 3px solid #00ff88; }
</style>
</head>
<body>
<h1><a href="">EVE HyperNet Profit Calculator</a></h1>

<div class="section">
<div class="row">
<div class="field">
<label>Item Name</label>
<input type="text" id="itemName" placeholder="e.g. PLEX (press Enter to search)">
<div class="hint" id="itemHint">Press Enter to lookup item price</div>
<div class="loading" id="itemLoading" style="display: none;">Searching...</div>
<div class="success" id="itemSuccess" style="display: none;"></div>
<div class="error" id="itemError"></div>
</div>
<div class="field">
<label>Item Price (ISK)</label>
<input type="number" id="itemPrice" min="0" value="1000000000">
</div>
<div class="field">
<label>Total Sell Value (ISK)</label>
<input type="number" id="sellValue" min="0" value="1100000000">
</div>
<div class="field">
<label>HyperCore Price (ISK)</label>
<input type="number" id="hypercorePrice" min="0" value="380000">
</div>
<div class="field">
<div class="label-with-tooltip">
<label>HyperCores @ 10T</label>
<span class="tooltip-icon">?</span>
</div>
<div class="tooltip">
<strong>How to get this value:</strong>
<ol>
<li>In game, create a new HyperNet listing for any item</li>
<li>Set the value to maximum: <code>10,000,000,000,000</code> (10 trillion ISK)</li>
<li>Note the total number of HyperCores required</li>
<li>Enter that number here</li>
</ol>
</div>
<input type="number" id="hypercoresAt10T" min="1" value="1000000">
</div>
</div>
<div class="row">
<div class="field">
<label>Number of Tickets</label>
<select id="numTickets">
<option value="8" selected>8</option>
<option value="16">16</option>
<option value="48">48</option>
<option value="512">512</option>
</select>
</div>
<div class="field">
<label>Self Purchased Tickets</label>
<input type="number" id="selfTickets" min="0" value="0">
<div class="error" id="ticketError"></div>
</div>
<div class="field">
<label>Number of Runs</label>
<input type="number" id="numRuns" min="1" value="1">
</div>
<div class="field">
<label>Rebate % (If You Win)</label>
<input type="number" id="rebatePercent" min="0" max="100" value="0">
</div>
<div class="field">
<label>Rebated Tickets</label>
<input type="number" id="rebateTickets" min="0" value="0">
<div class="error" id="rebateError"></div>
</div>
</div>
<div class="rebate-info" id="rebateInfo" style="display: none;">
Rebate active: If you win, you'll pay out <span id="rebateAmount">-</span> ISK to <span id="rebateCount">-</span> other ticket holders.
</div>
</div>



<div class="section">
<h2>Per Run Analysis</h2>
<div class="results" style="margin-bottom: 15px;">
<div class="result-item"><label>Per Ticket</label><div class="value" id="perTicket">-</div></div>
<div class="result-item"><label>HyperCores</label><div class="value" id="hypercores">-</div></div>
<div class="result-item"><label>Cores Cost</label><div class="value" id="hypercoreCost">-</div></div>
<div class="result-item"><label>Win Chance</label><div class="value" id="winChance">-</div></div>
<div class="result-item"><label>Gross</label><div class="value" id="grossRev">-</div></div>
<div class="result-item"><label>Tax (5%)</label><div class="value" id="taxAmt">-</div></div>
<div class="result-item"><label>Net</label><div class="value" id="netRev">-</div></div>
<div class="result-item"><label>Self Tickets</label><div class="value" id="selfCost">-</div></div>
</div>
<table class="breakdown-table">
<tr><th></th><th>Item Cost</th><th>Self Tickets</th><th>HyperCores</th><th>Rebate Paid</th><th>Total Out</th><th>Net Revenue</th><th>Item Won</th><th>Total In</th><th>Profit/Loss</th></tr>
<tr><td>If You Lose</td><td id="loseItem">-</td><td id="loseSelf">-</td><td id="loseHC">-</td><td>-</td><td id="loseOut">-</td><td id="loseRev">-</td><td>-</td><td id="loseIn">-</td><td id="loseProfit">-</td></tr>
<tr><td>If You Win</td><td id="winItem">-</td><td id="winSelf">-</td><td id="winHC">-</td><td id="winRebate">-</td><td id="winOut">-</td><td id="winRev">-</td><td id="winWon">-</td><td id="winIn">-</td><td id="winProfit">-</td></tr>
<tr style="border-top: 2px solid #00d4ff;"><td>Average</td><td id="avgItem">-</td><td id="avgSelf">-</td><td id="avgHC">-</td><td id="avgRebate">-</td><td id="avgOut">-</td><td id="avgRev">-</td><td id="avgWon">-</td><td id="avgIn">-</td><td id="avgProfitRow">-</td></tr>
</table>
</div>

<div class="section">
<h2>Expected Average Over Runs</h2>
<div class="results results-runs">
<div class="result-item"><label>Expected Wins</label><div class="value" id="expectedWins">-</div></div>
<div class="result-item"><label>Expected Losses</label><div class="value" id="expectedLosses">-</div></div>
<div class="result-item"><label>Total Investment</label><div class="value" id="totalInvest">-</div></div>
<div class="result-item"><label>Total Expected Profit</label><div class="value" id="totalProfit">-</div></div>
<div class="result-item"><label>ROI %</label><div class="value" id="roi">-</div></div>
<div class="result-item"><label>No Win Likelihood</label><div class="value" id="riskLoss">-</div></div>
</div>
</div>

<center>
<div class="share-container">
<button class="share-btn" onclick="generateShareLink()">Generate & Copy Shareable Link</button>
<div class="share-result" id="shareResult">
<a href="#" class="share-link" id="shareLink" target="_blank"></a>
<div class="success" id="copySuccess" style="margin-top: 10px;">Link copied to clipboard!</div>
</div>
</div>
</center>

<script>
function isk(n) {
  const abs = Math.abs(n);
  const sign = n < 0 ? '-' : '';
  if (abs >= 1e9) return sign + (abs / 1e9).toFixed(2) + 'B';
  if (abs >= 1e6) return sign + (abs / 1e6).toFixed(2) + 'M';
  if (abs >= 1e3) return sign + (abs / 1e3).toFixed(2) + 'K';
  return sign + abs.toFixed(2);
}

async function loadConfigFromHash() {
  const hash = window.location.hash.substring(1);
  if (!hash) return;
  
  const config = await decodeConfig(hash);
  if (!config) return;
  
  document.getElementById('itemName').value = config.in || '';
  document.getElementById('itemPrice').value = config.ip || 0;
  document.getElementById('sellValue').value = config.sv || 0;
  document.getElementById('hypercorePrice').value = config.hp || 0;
  document.getElementById('hypercoresAt10T').value = config.hc || 1000000;
  document.getElementById('numTickets').value = config.nt || 8;
  document.getElementById('selfTickets').value = config.st || 0;
  document.getElementById('numRuns').value = config.nr || 1;
  document.getElementById('rebatePercent').value = config.rp || 0;
  document.getElementById('rebateTickets').value = config.rt || 0;
  
  calc();
  
  const success = document.getElementById('itemSuccess');
  success.textContent = 'Configuration loaded from shared link!';
  success.style.display = 'block';
  setTimeout(() => { success.style.display = 'none'; }, 3000);
}

async function generateShareLink() {
  const encoded = await encodeConfig();
  const url = window.location.href.split('#')[0] + '#' + encoded;
  
  const shareLink = document.getElementById('shareLink');
  shareLink.href = url;
  shareLink.textContent = url;
  
  document.getElementById('shareResult').style.display = 'block';
  
  navigator.clipboard.writeText(url).then(() => {
    const success = document.getElementById('copySuccess');
    success.style.display = 'block';
    setTimeout(() => { success.style.display = 'none'; }, 2000);
  }).catch(err => {
    console.error('Failed to copy:', err);
  });
}

async function searchItem(itemName) {
  if (!itemName || itemName.trim().length === 0) return null;
  
  try {
    const response = await fetch('https://esi.evetech.net/latest/universe/ids/', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify([itemName.trim()])
    });
    
    if (!response.ok) return null;
    const data = await response.json();
    return data.inventory_types?.[0] || null;
  } catch (error) {
    console.error('Search error:', error);
    return null;
  }
}

async function getMarketPrice(typeId) {
  try {
    const response = await fetch('https://esi.evetech.net/latest/markets/prices/');
    if (!response.ok) return null;
    
    const prices = await response.json();
    const itemPrice = prices.find(p => p.type_id === typeId);
    return itemPrice?.average_price || null;
  } catch (error) {
    console.error('Price lookup error:', error);
    return null;
  }
}

async function lookupItem() {
  const itemNameInput = document.getElementById('itemName');
  const itemPriceInput = document.getElementById('itemPrice');
  const loading = document.getElementById('itemLoading');
  const success = document.getElementById('itemSuccess');
  const error = document.getElementById('itemError');
  const hint = document.getElementById('itemHint');
  
  const itemName = itemNameInput.value.trim();
  
  if (!itemName) {
    error.textContent = 'Please enter an item name';
    return;
  }
  
  hint.style.display = 'none';
  loading.style.display = 'block';
  success.style.display = 'none';
  error.textContent = '';
  
  const item = await searchItem(itemName);
  
  if (!item) {
    loading.style.display = 'none';
    error.textContent = 'Item not found. Please check the exact item name.';
    hint.style.display = 'block';
    return;
  }
  
  const price = await getMarketPrice(item.id);
  loading.style.display = 'none';
  
  if (price) {
    itemPriceInput.value = Math.round(price);
    success.textContent = `Loaded market price for "${item.name}": ${isk(price)} ISK`;
    success.style.display = 'block';
    setTimeout(() => { 
      success.style.display = 'none'; 
      hint.style.display = 'block';
    }, 5000);
    calc();
  } else {
    error.textContent = `Found "${item.name}" but no market price available`;
    hint.style.display = 'block';
  }
}

document.getElementById('itemName').addEventListener('keypress', (e) => {
  if (e.key === 'Enter') {
    e.preventDefault();
    lookupItem();
  }
});

function calc() {
  const itemPrice = parseFloat(document.getElementById('itemPrice').value) || 0;
  const numTickets = parseInt(document.getElementById('numTickets').value);
  const selfTickets = parseInt(document.getElementById('selfTickets').value) || 0;
  const sellValue = parseFloat(document.getElementById('sellValue').value) || 0;
  const hypercorePrice = parseFloat(document.getElementById('hypercorePrice').value) || 0;
  const numRuns = parseInt(document.getElementById('numRuns').value) || 1;
  const hypercoresAt10T = parseFloat(document.getElementById('hypercoresAt10T').value) || 1000000;
  const rebatePercent = parseFloat(document.getElementById('rebatePercent').value) || 0;
  const rebateTickets = parseInt(document.getElementById('rebateTickets').value) || 0;
  
  const errEl = document.getElementById('ticketError');
  if (selfTickets > numTickets) {
    errEl.textContent = 'Cannot exceed total tickets';
    return;
  }
  errEl.textContent = '';

  const rebateErrEl = document.getElementById('rebateError');
  const maxRebateTickets = numTickets - selfTickets;
  if (rebateTickets > maxRebateTickets) {
    rebateErrEl.textContent = `Max ${maxRebateTickets} (excludes self tickets)`;
    return;
  }
  rebateErrEl.textContent = '';

  const ratio = 10000000000000 / hypercoresAt10T;
  const perTicket = sellValue / numTickets;
  const hypercores = Math.max(1, Math.floor(sellValue / ratio));
  const hypercoreCost = hypercores * hypercorePrice;
  const winChance = selfTickets / numTickets;
  const grossRev = numTickets * perTicket;
  const taxAmt = grossRev * 0.05;
  const netRev = grossRev * 0.95;
  const selfCost = selfTickets * perTicket;

  // Calculate rebate amounts (only for other people's tickets, not self)
  const rebatePerTicket = perTicket * (rebatePercent / 100);
  const totalRebatePaid = rebateTickets * rebatePerTicket;

  // Show rebate info
  const rebateInfo = document.getElementById('rebateInfo');
  if (rebatePercent > 0 && rebateTickets > 0) {
    rebateInfo.style.display = 'block';
    document.getElementById('rebateAmount').textContent = isk(totalRebatePaid);
    document.getElementById('rebateCount').textContent = rebateTickets;
  } else {
    rebateInfo.style.display = 'none';
  }

  document.getElementById('perTicket').textContent = isk(perTicket);
  document.getElementById('hypercores').textContent = hypercores;
  document.getElementById('hypercoreCost').textContent = isk(hypercoreCost);
  document.getElementById('winChance').textContent = (winChance * 100).toFixed(2) + '%';
  document.getElementById('grossRev').textContent = isk(grossRev);
  document.getElementById('taxAmt').textContent = isk(taxAmt);
  document.getElementById('netRev').textContent = isk(netRev);
  document.getElementById('selfCost').textContent = isk(selfCost);

  // If you lose - no rebate paid
  const baseOut = itemPrice + selfCost + hypercoreCost;
  const loseOut = baseOut;
  const loseIn = netRev;
  const loseProfit = loseIn - loseOut;

  // If you win - rebate is paid
  const winOut = baseOut + totalRebatePaid;
  const winIn = netRev + itemPrice;
  const winProfit = winIn - winOut;

  document.getElementById('loseItem').textContent = isk(itemPrice);
  document.getElementById('loseSelf').textContent = isk(selfCost);
  document.getElementById('loseHC').textContent = isk(hypercoreCost);
  document.getElementById('loseOut').textContent = isk(loseOut);
  document.getElementById('loseRev').textContent = isk(netRev);
  document.getElementById('loseIn').textContent = isk(loseIn);
  const lpEl = document.getElementById('loseProfit');
  lpEl.textContent = isk(loseProfit);
  lpEl.className = loseProfit >= 0 ? 'profit' : 'loss';

  document.getElementById('winItem').textContent = isk(itemPrice);
  document.getElementById('winSelf').textContent = isk(selfCost);
  document.getElementById('winHC').textContent = isk(hypercoreCost);
  document.getElementById('winRebate').textContent = isk(totalRebatePaid);
  document.getElementById('winOut').textContent = isk(winOut);
  document.getElementById('winRev').textContent = isk(netRev);
  document.getElementById('winWon').textContent = isk(itemPrice);
  document.getElementById('winIn').textContent = isk(winIn);
  const wpEl = document.getElementById('winProfit');
  wpEl.textContent = isk(winProfit);
  wpEl.className = winProfit >= 0 ? 'profit' : 'loss';

  const expectedWins = numRuns * winChance;
  const expectedLosses = numRuns * (1 - winChance);
  const avgRebatePaid = totalRebatePaid * winChance;
  const avgProfitVal = (winProfit * winChance) + (loseProfit * (1 - winChance));
  const totalProfitVal = avgProfitVal * numRuns;
  const avgOutVal = baseOut + avgRebatePaid;
  const totalInvest = avgOutVal * numRuns;
  const roiVal = totalInvest > 0 ? (totalProfitVal / totalInvest) * 100 : 0;
  const avgWonVal = itemPrice * winChance;
  const avgInVal = netRev + avgWonVal;
  
  // Calculate risk of total loss (losing all runs)
  const loseChance = 1 - winChance;
  const riskTotalLoss = Math.pow(loseChance, numRuns) * 100;

  document.getElementById('avgItem').textContent = isk(itemPrice);
  document.getElementById('avgSelf').textContent = isk(selfCost);
  document.getElementById('avgHC').textContent = isk(hypercoreCost);
  document.getElementById('avgRebate').textContent = isk(avgRebatePaid);
  document.getElementById('avgOut').textContent = isk(avgOutVal);
  document.getElementById('avgRev').textContent = isk(netRev);
  document.getElementById('avgWon').textContent = isk(avgWonVal);
  document.getElementById('avgIn').textContent = isk(avgInVal);
  const aprEl = document.getElementById('avgProfitRow');
  aprEl.textContent = isk(avgProfitVal);
  aprEl.className = avgProfitVal >= 0 ? 'profit' : 'loss';

  document.getElementById('expectedWins').textContent = expectedWins.toFixed(2);
  document.getElementById('expectedLosses').textContent = expectedLosses.toFixed(2);
  document.getElementById('totalInvest').textContent = isk(totalInvest);
  const tpEl = document.getElementById('totalProfit');
  tpEl.textContent = isk(totalProfitVal);
  tpEl.className = 'value ' + (totalProfitVal >= 0 ? 'profit' : 'loss');
  const roiEl = document.getElementById('roi');
  roiEl.textContent = roiVal.toFixed(2) + '%';
  roiEl.className = 'value ' + (roiVal >= 0 ? 'profit' : 'loss');
  const riskEl = document.getElementById('riskLoss');
  riskEl.textContent = riskTotalLoss.toFixed(2) + '%';
  riskEl.className = 'value ' + (riskTotalLoss > 50 ? 'loss' : riskTotalLoss > 25 ? 'value' : 'profit');
}

function b62(n) {
  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
  if (n === 0) return '0';
  let result = '';
  while (n > 0) {
    result = chars[n % 62] + result;
    n = Math.floor(n / 62);
  }
  return result;
}

function unb62(s) {
  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
  let result = 0;
  for (let i = 0; i < s.length; i++) {
    result = result * 62 + chars.indexOf(s[i]);
  }
  return result;
}

function strToB62(str) {
  if (!str) return '';
  const bytes = new TextEncoder().encode(str);
  let result = '';
  for (let i = 0; i < bytes.length; i += 3) {
    const chunk = bytes.slice(i, i + 3);
    let num = 0;
    for (let j = 0; j < chunk.length; j++) {
      num = num * 256 + chunk[j];
    }
    result += b62(num);
    if (i + 3 < bytes.length) result += '.';
  }
  return result;
}

function b62ToStr(encoded) {
  if (!encoded) return '';
  const chunks = encoded.split('.');
  const bytes = [];
  for (const chunk of chunks) {
    let num = unb62(chunk);
    const chunkBytes = [];
    while (num > 0) {
      chunkBytes.unshift(num % 256);
      num = Math.floor(num / 256);
    }
    bytes.push(...chunkBytes);
  }
  return new TextDecoder().decode(new Uint8Array(bytes));
}

async function encodeConfig() {
  const d = ['', 1000000000, 1100000000, 380000, 1000000, 8, 0, 1, 0, 0];
  const v = [
    document.getElementById('itemName').value,
    parseFloat(document.getElementById('itemPrice').value) || 0,
    parseFloat(document.getElementById('sellValue').value) || 0,
    parseFloat(document.getElementById('hypercorePrice').value) || 0,
    parseFloat(document.getElementById('hypercoresAt10T').value) || 1000000,
    parseInt(document.getElementById('numTickets').value),
    parseInt(document.getElementById('selfTickets').value) || 0,
    parseInt(document.getElementById('numRuns').value) || 1,
    parseFloat(document.getElementById('rebatePercent').value) || 0,
    parseInt(document.getElementById('rebateTickets').value) || 0
  ];
  
  const p = [];
  for (let i = 0; i < v.length; i++) {
    if (i === 0) {
      if (v[i]) p.push('0:' + strToB62(v[i]));
    } else if (v[i] !== d[i]) {
      p.push(i + ':' + b62(v[i]));
    }
  }
  return p.join('~');
}

async function decodeConfig(encoded) {
  try {
    const d = ['', 1000000000, 1100000000, 380000, 1000000, 8, 0, 1, 0, 0];
    const v = [...d];
    const parts = encoded.split('~');
    
    for (const p of parts) {
      const [idx, val] = p.split(':');
      const i = parseInt(idx);
      if (i === 0) {
        v[0] = b62ToStr(val);
      } else {
        v[i] = unb62(val);
      }
    }
    
    return {
      in: v[0] || '',
      ip: v[1] || 0,
      sv: v[2] || 0,
      hp: v[3] || 0,
      hc: v[4] || 1000000,
      nt: v[5] || 8,
      st: v[6] || 0,
      nr: v[7] || 1,
      rp: v[8] || 0,
      rt: v[9] || 0
    };
  } catch (e) {
    console.error('Failed to decode config:', e);
    return null;
  }
}

document.querySelectorAll('input:not(#itemName), select').forEach(el => el.addEventListener('input', calc));
window.addEventListener('DOMContentLoaded', loadConfigFromHash);
calc();
</script>
</body>
</html>
